import numpy as np
import pandas as pd
from sklearn.ensemble import IsolationForest
import pickle
import matplotlib.pyplot as plt

def clean_csv(file_path):
    # Read the file as text
    with open(file_path, 'r') as file:
        lines = file.readlines()

    # Filter out lines that contain 'array'
    cleaned_lines = [line for line in lines if 'array' not in line]

    # Write the cleaned lines back to a new file
    cleaned_file_path = file_path.replace('.csv', '_cleaned.csv')
    with open(cleaned_file_path, 'w') as file:
        file.writelines(cleaned_lines)

    return cleaned_file_path


# Load and preprocess the data
def load_data(deviation_file, rate_of_change_file, normalized_file):
    # Read the CSV files
    deviation_data = pd.read_csv(deviation_file, header=None, skiprows=1)  # Skip header if needed
    rate_of_change_data = pd.read_csv(rate_of_change_file, header=None, skiprows=1)
    normalized_data = pd.read_csv(normalized_file, header=None, skiprows=1)

    # Convert to numeric, forcing errors to NaN (non-numeric strings will be converted to NaN)
    deviation_data = pd.to_numeric(deviation_data, errors='coerce').values
    rate_of_change_data = pd.to_numeric(rate_of_change_data, errors='coerce').values
    normalized_data = pd.to_numeric(normalized_data, errors='coerce').values

    # Flatten the arrays and combine them into a feature vector
    features = np.hstack([
        deviation_data.flatten(), 
        rate_of_change_data.flatten(), 
        normalized_data.flatten()
    ]).reshape(-1, 3)  # Reshape for (samples, features)

    return features
# Train the anomaly detection model
def train_anomaly_model(features, model_path="anomaly_model.pkl"):
    # Initialize and train the Isolation Forest model
    model = IsolationForest(contamination=0.05)  # Adjust contamination level
    model.fit(features)

    # Save the trained model
    with open(model_path, "wb") as f:
        pickle.dump(model, f)

    print("Anomaly detection model trained and saved.")

# Detect anomalies on new data
def detect_anomalies(features, model_path="anomaly_model.pkl"):
    # Load the pre-trained model
    with open(model_path, "rb") as f:
        model = pickle.load(f)

    # Predict anomalies (1 = normal, -1 = anomaly)
    predictions = model.predict(features)
    return predictions

def check_drunk_or_sober(new_data, model_path="anomaly_model.pkl"):
    # Flatten the new data and reshape it to match the model input format
    new_data_array = np.array(new_data).flatten().reshape(1, -1)

    # Detect anomalies in the new data
    anomaly_predictions = detect_anomalies(new_data_array, model_path)

    # Determine if the data is "drunk" or "sober"
    if anomaly_predictions == -1:
        return "Drunk (Anomaly detected)"
    else:
        return "Sober (Normal data)"

# Visualization function for anomalies (Optional)
def visualize_anomalies(features, anomaly_predictions):
    # Separate normal and anomalous data
    normal_data = features[anomaly_predictions == 1]
    anomalous_data = features[anomaly_predictions == -1]

    # Plot the data
    plt.figure(figsize=(10, 6))
    plt.scatter(range(len(features)), features[:, 0], label="Deviation Data", alpha=0.5)
    plt.scatter(range(len(features)), features[:, 1], label="Rate of Change Data", alpha=0.5)
    plt.scatter(range(len(features)), features[:, 2], label="Normalized Data", alpha=0.5)

    # Highlight anomalies
    plt.scatter(
        np.where(anomaly_predictions == -1)[0],
        features[anomaly_predictions == -1, 0],
        color="red",
        label="Anomalies",
        zorder=10
    )

    plt.xlabel("Sample Index")
    plt.ylabel("Feature Value")
    plt.title("Anomaly Detection Results")
    plt.legend()
    plt.show()

# Example Usage

# Paths to your CSV files
deviation_file = "/Users/nickhunnell/Desktop/Machine Learning/deviation_data.csv"
rate_of_change_file = "/Users/nickhunnell/Desktop/Machine Learning/rate_change_data.csv"
normalized_file = "/Users/nickhunnell/Desktop/Machine Learning/normalized_data.csv"

# Load the training data
features = load_data(deviation_file, rate_of_change_file, normalized_file)

# Train the anomaly detection model on the training data
train_anomaly_model(features)

# Check if new data is drunk or sober
# Example: new data input (must have the same format as the training data)
new_data = [([0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.09574468, 0.08510638, 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        ]), ([0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.11842105, 0.10526316, 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        ])], ([ 0.12765957,  0.11702128,  0.08510638,  0.08510638,  0.08510638,
        0.05319149,  0.03191489,  0.0212766 ,  0.03191489,  0.0212766 ,
        0.        , -0.0106383 , -0.0106383 ,  0.        , -0.0106383 ,
       -0.0106383 ,  0.        ,  0.        , -0.0106383 ,  0.        ,
        0.0106383 , -0.0212766 , -0.03191489, -0.0212766 , -0.0106383 ,
       -0.0212766 , -0.03191489,  0.        ,  0.0212766 ,  0.        ,
       -0.0106383 ,  0.        , -0.0106383 , -0.0212766 , -0.0212766 ,
        0.        ,  0.        , -0.0106383 ,  0.        , -0.0212766 ,
       -0.03191489, -0.0212766 , -0.0212766 , -0.0106383 ,  0.        ,
       -0.0106383 , -0.0106383 , -0.0106383 , -0.03191489, -0.05319149,
       -0.04255319, -0.03191489, -0.03191489, -0.0106383 , -0.0106383 ,
       -0.0106383 ,  0.        ,  0.        , -0.0106383 , -0.0212766 ,
       -0.0106383 ,  0.        , -0.0106383 ,  0.0106383 ,  0.04255319,
        0.0106383 , -0.0212766 ,  0.0106383 ,  0.04255319,  0.03191489,
        0.        , -0.0106383 ,  0.0106383 ,  0.0106383 , -0.0106383 ,
       -0.0106383 , -0.0106383 , -0.03191489, -0.03191489, -0.0212766 ,
       -0.0212766 , -0.0212766 , -0.0106383 ,  0.        , -0.0212766 ,
       -0.03191489, -0.0106383 , -0.0212766 , -0.04255319, -0.04255319,
       -0.03191489, -0.04255319, -0.05319149, -0.0212766 ,  0.0106383 ,
        0.0212766 ,  0.03191489,  0.06382979,  0.09574468,  0.08510638,
        0.06382979,  0.05319149,  0.        , -0.03191489,  0.        ,
        0.0106383 , -0.0106383 ,  0.        ,  0.0106383 , -0.0106383 ,
       -0.0106383 ,  0.0106383 , -0.0106383 , -0.0212766 ,  0.        ,
       -0.0106383 , -0.0106383 ,  0.0106383 ,  0.0106383 , -0.0106383 ,
       -0.0106383 ,  0.        ,  0.0106383 ,  0.0212766 ,  0.0212766 ,
        0.0106383 ,  0.0106383 ,  0.0106383 , -0.0106383 ,  0.        ,
        0.0106383 ,  0.        ,  0.0106383 ,  0.        ,  0.        ,
        0.0212766 ,  0.0212766 ,  0.0106383 ,  0.        ,  0.        ,
        0.        ,  0.        , -0.0212766 , -0.04255319, -0.0212766 ,
        0.        ,  0.        , -0.0106383 , -0.0212766 , -0.0106383 ,
        0.        ,  0.0106383 ,  0.0106383 , -0.0106383 , -0.0106383 ,
        0.        , -0.0106383 , -0.0106383 ,  0.0106383 ,  0.0106383 ,
        0.        , -0.0106383 , -0.0106383 , -0.0106383 , -0.0212766 ,
       -0.0106383 ,  0.        ,  0.0106383 ,  0.0106383 ,  0.0106383 ,
        0.0106383 ,  0.        ,  0.0106383 ,  0.0106383 ,  0.        ,
        0.0106383 ,  0.0106383 ,  0.        ,  0.0106383 , -0.0106383 ,
       -0.03191489, -0.0106383 , -0.0106383 , -0.0212766 , -0.0106383 ,
       -0.0212766 , -0.03191489, -0.0106383 ,  0.0106383 ,  0.0106383 ,
       -0.0106383 , -0.0106383 ,  0.0106383 ,  0.0106383 ,  0.0106383 ,
        0.        , -0.0106383 ,  0.0106383 ,  0.        , -0.0212766 ,
       -0.0106383 , -0.0106383 , -0.0106383 , -0.0106383 , -0.0212766 ,
       -0.03191489, -0.03191489, -0.0212766 ,  0.        ,  0.0106383 ,
       -0.0106383 , -0.0106383 , -0.0212766 , -0.03191489, -0.0212766 ,
       -0.0106383 ,  0.        ,  0.        ,  0.        ,  0.0106383 ,
        0.0212766 ,  0.0212766 ,  0.0212766 ,  0.03191489,  0.05319149,
        0.04255319,  0.0212766 ,  0.03191489,  0.04255319,  0.04255319,
        0.05319149,  0.05319149,  0.0106383 , -0.0106383 ,  0.0106383 ,
        0.0212766 ,  0.        , -0.0106383 ,  0.0106383 ,  0.0106383 ,
        0.        ,  0.0212766 ,  0.        , -0.04255319, -0.0106383 ,
        0.0212766 ,  0.        ,  0.        ,  0.0106383 ,  0.0106383 ,
        0.0212766 ,  0.03191489,  0.03191489,  0.04255319,  0.05319149,
        0.0106383 , -0.0212766 , -0.0106383 ,  0.        , -0.0106383 ,
       -0.03191489, -0.0212766 , -0.0106383 , -0.0106383 , -0.0212766 ,
       -0.03191489, -0.0106383 ,  0.        , -0.0106383 ,  0.        ,
        0.0106383 , -0.0106383 ,  0.        ,  0.0212766 , -0.0106383 ,
       -0.0212766 ,  0.0106383 ,  0.0106383 ,  0.        ,  0.0106383 ,
        0.        , -0.0212766 ,  0.        ,  0.0106383 ,  0.        ,
        0.0212766 ,  0.0212766 ,  0.0106383 ,  0.0106383 ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.0106383 ,  0.0212766 ,  0.0106383 ,  0.0106383 ,  0.0106383 ,
        0.        ,  0.        ,  0.        ,  0.        , -0.0106383 ,
       -0.0106383 , -0.0106383 , -0.0212766 , -0.0106383 ,  0.        ,
       -0.0106383 , -0.0212766 , -0.0106383 ,  0.0106383 ,  0.        ,
       -0.0106383 , -0.0106383 , -0.0106383 ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.0212766 ,  0.0212766 ,
        0.0106383 ,  0.0212766 ,  0.0212766 ,  0.0212766 ,  0.0106383 ,
        0.        ,  0.        ,  0.        ,  0.0106383 ,  0.        ,
       -0.0212766 ,  0.        ,  0.0212766 ,  0.0106383 ,  0.0106383 ,
        0.0106383 ,  0.        ,  0.0106383 ,  0.0106383 , -0.0106383 ,
       -0.0212766 , -0.0212766 , -0.0106383 , -0.0106383 , -0.04255319,
       -0.05319149, -0.05319149, -0.05319149, -0.04255319, -0.05319149,
       -0.05319149, -0.04255319, -0.03191489, -0.0212766 , -0.03191489,
       -0.04255319, -0.0212766 ,  0.0106383 ,  0.03191489,  0.05319149,
        0.06382979,  0.05319149,  0.03191489,  0.0106383 ,  0.0212766 ,
        0.0106383 ,  0.        ,  0.0212766 ,  0.0106383 ,  0.0212766 ,
        0.0106383 , -0.0212766 ]), ([ 0.13157895,  0.13157895,  0.11842105,  0.10526316,  0.09210526,
        0.06578947,  0.02631579,  0.01315789,  0.05263158,  0.03947368,
        0.        , -0.01315789, -0.01315789,  0.        , -0.01315789,
       -0.01315789,  0.01315789,  0.01315789,  0.        ,  0.        ,
        0.        , -0.01315789, -0.03947368, -0.01315789,  0.        ,
       -0.03947368, -0.02631579,  0.        ,  0.01315789,  0.01315789,
        0.        ,  0.        , -0.01315789, -0.02631579, -0.01315789,
        0.        , -0.01315789, -0.01315789,  0.01315789, -0.01315789,
       -0.03947368, -0.01315789, -0.01315789, -0.01315789,  0.        ,
       -0.01315789, -0.01315789, -0.01315789, -0.03947368, -0.05263158,
       -0.05263158, -0.05263158, -0.02631579, -0.01315789, -0.01315789,
        0.        ,  0.01315789,  0.01315789, -0.01315789, -0.02631579,
       -0.01315789,  0.        , -0.01315789,  0.01315789,  0.03947368,
        0.01315789,  0.        ,  0.02631579,  0.05263158,  0.03947368,
        0.01315789,  0.        ,  0.        ,  0.01315789,  0.        ,
       -0.01315789, -0.01315789, -0.02631579, -0.02631579, -0.02631579,
       -0.01315789, -0.01315789, -0.01315789,  0.        , -0.01315789,
       -0.03947368, -0.02631579, -0.01315789, -0.02631579, -0.03947368,
       -0.03947368, -0.03947368, -0.06578947, -0.02631579,  0.02631579,
        0.03947368,  0.06578947,  0.07894737,  0.11842105,  0.10526316,
        0.05263158,  0.03947368,  0.        , -0.02631579, -0.01315789,
        0.        , -0.01315789,  0.        ,  0.01315789, -0.01315789,
       -0.01315789,  0.01315789, -0.01315789, -0.03947368, -0.02631579,
       -0.02631579, -0.01315789,  0.        ,  0.01315789,  0.01315789,
        0.        ,  0.        ,  0.01315789,  0.02631579,  0.02631579,
        0.01315789,  0.        ,  0.01315789,  0.        ,  0.        ,
        0.01315789,  0.        ,  0.02631579,  0.01315789,  0.        ,
        0.02631579,  0.01315789,  0.        ,  0.02631579,  0.02631579,
       -0.01315789, -0.02631579, -0.03947368, -0.05263158, -0.02631579,
        0.        ,  0.        ,  0.        , -0.01315789, -0.02631579,
       -0.01315789,  0.        ,  0.        , -0.01315789, -0.01315789,
        0.01315789, -0.01315789, -0.01315789,  0.02631579,  0.01315789,
        0.        ,  0.        , -0.01315789, -0.02631579, -0.02631579,
        0.        ,  0.01315789,  0.        ,  0.02631579,  0.05263158,
        0.01315789, -0.01315789,  0.01315789,  0.02631579,  0.01315789,
        0.01315789,  0.01315789,  0.        ,  0.01315789,  0.        ,
       -0.03947368, -0.02631579, -0.01315789, -0.01315789, -0.01315789,
       -0.02631579, -0.01315789,  0.        ,  0.01315789,  0.01315789,
        0.        ,  0.        ,  0.        ,  0.01315789,  0.01315789,
       -0.01315789, -0.01315789,  0.        ,  0.        , -0.02631579,
       -0.02631579,  0.        , -0.01315789, -0.01315789, -0.01315789,
       -0.02631579, -0.01315789,  0.        ,  0.        ,  0.01315789,
        0.01315789, -0.01315789, -0.03947368, -0.03947368, -0.01315789,
        0.        ,  0.01315789,  0.02631579,  0.01315789,  0.02631579,
        0.03947368,  0.03947368,  0.03947368,  0.03947368,  0.05263158,
        0.05263158,  0.03947368,  0.02631579,  0.02631579,  0.02631579,
        0.03947368,  0.05263158,  0.02631579,  0.        ,  0.        ,
        0.        , -0.01315789, -0.01315789,  0.        ,  0.        ,
       -0.01315789,  0.        ,  0.01315789, -0.02631579, -0.02631579,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.01315789,  0.03947368,  0.05263158,  0.03947368,  0.02631579,
        0.01315789, -0.01315789, -0.02631579, -0.01315789, -0.01315789,
       -0.02631579, -0.01315789, -0.01315789, -0.02631579, -0.02631579,
       -0.02631579, -0.01315789,  0.01315789,  0.        , -0.01315789,
        0.        ,  0.        , -0.01315789,  0.        ,  0.01315789,
       -0.01315789,  0.        ,  0.02631579,  0.        ,  0.        ,
        0.        , -0.02631579, -0.01315789, -0.01315789,  0.01315789,
        0.02631579,  0.02631579,  0.02631579, -0.01315789, -0.01315789,
        0.        ,  0.        ,  0.        , -0.01315789, -0.01315789,
        0.01315789,  0.03947368,  0.01315789,  0.        ,  0.01315789,
       -0.01315789,  0.        ,  0.01315789,  0.        ,  0.        ,
        0.        , -0.01315789, -0.02631579,  0.        ,  0.        ,
       -0.01315789,  0.        , -0.01315789, -0.01315789,  0.        ,
        0.        , -0.02631579, -0.01315789,  0.01315789,  0.        ,
        0.        ,  0.01315789,  0.02631579,  0.02631579,  0.01315789,
        0.01315789,  0.02631579,  0.02631579,  0.02631579,  0.01315789,
        0.        ,  0.        ,  0.01315789,  0.01315789, -0.01315789,
        0.        ,  0.02631579,  0.02631579,  0.01315789,  0.        ,
        0.02631579,  0.01315789,  0.01315789,  0.01315789, -0.01315789,
       -0.01315789, -0.01315789, -0.01315789, -0.01315789, -0.03947368,
       -0.06578947, -0.05263158, -0.06578947, -0.06578947, -0.03947368,
       -0.03947368, -0.03947368, -0.01315789, -0.02631579, -0.05263158,
       -0.05263158, -0.01315789,  0.02631579,  0.02631579,  0.03947368,
        0.06578947,  0.06578947,  0.02631579,  0.01315789,  0.03947368,
        0.02631579,  0.        ,  0.01315789,  0.02631579,  0.01315789,
        0.01315789,  0.02631579]), ([0.40425532, 0.53191489, 0.63829787, 0.70212766, 0.80851064,
       0.87234043, 0.91489362, 0.93617021, 0.95744681, 1.        ,
       1.        , 1.        , 0.9787234 , 0.9787234 , 0.9787234 ,
       0.95744681, 0.95744681, 0.95744681, 0.95744681, 0.93617021,
       0.95744681, 0.95744681, 0.91489362, 0.89361702, 0.87234043,
       0.87234043, 0.82978723, 0.80851064, 0.82978723, 0.85106383,
       0.82978723, 0.82978723, 0.82978723, 0.80851064, 0.78723404,
       0.76595745, 0.78723404, 0.76595745, 0.76595745, 0.76595745,
       0.72340426, 0.70212766, 0.68085106, 0.65957447, 0.65957447,
       0.65957447, 0.63829787, 0.63829787, 0.61702128, 0.57446809,
       0.5106383 , 0.4893617 , 0.44680851, 0.42553191, 0.42553191,
       0.40425532, 0.40425532, 0.40425532, 0.40425532, 0.38297872,
       0.36170213, 0.36170213, 0.36170213, 0.34042553, 0.38297872,
       0.42553191, 0.40425532, 0.38297872, 0.42553191, 0.46808511,
       0.4893617 , 0.46808511, 0.46808511, 0.4893617 , 0.4893617 ,
       0.46808511, 0.46808511, 0.44680851, 0.40425532, 0.38297872,
       0.36170213, 0.34042553, 0.31914894, 0.31914894, 0.31914894,
       0.27659574, 0.25531915, 0.25531915, 0.21276596, 0.17021277,
       0.12765957, 0.10638298, 0.04255319, 0.        , 0.        ,
       0.0212766 , 0.04255319, 0.08510638, 0.17021277, 0.27659574,
       0.34042553, 0.40425532, 0.44680851, 0.40425532, 0.38297872,
       0.40425532, 0.40425532, 0.38297872, 0.40425532, 0.40425532,
       0.38297872, 0.38297872, 0.40425532, 0.36170213, 0.36170213,
       0.36170213, 0.34042553, 0.34042553, 0.36170213, 0.36170213,
       0.34042553, 0.34042553, 0.34042553, 0.36170213, 0.38297872,
       0.40425532, 0.40425532, 0.42553191, 0.42553191, 0.40425532,
       0.42553191, 0.42553191, 0.42553191, 0.44680851, 0.42553191,
       0.44680851, 0.46808511, 0.4893617 , 0.4893617 , 0.4893617 ,
       0.4893617 , 0.4893617 , 0.4893617 , 0.44680851, 0.40425532,
       0.40425532, 0.40425532, 0.40425532, 0.38297872, 0.36170213,
       0.36170213, 0.36170213, 0.38297872, 0.38297872, 0.36170213,
       0.36170213, 0.36170213, 0.34042553, 0.34042553, 0.36170213,
       0.36170213, 0.36170213, 0.34042553, 0.34042553, 0.31914894,
       0.29787234, 0.29787234, 0.29787234, 0.31914894, 0.31914894,
       0.34042553, 0.34042553, 0.34042553, 0.36170213, 0.36170213,
       0.36170213, 0.38297872, 0.38297872, 0.38297872, 0.40425532,
       0.36170213, 0.34042553, 0.34042553, 0.31914894, 0.29787234,
       0.29787234, 0.25531915, 0.23404255, 0.23404255, 0.25531915,
       0.25531915, 0.23404255, 0.23404255, 0.25531915, 0.25531915,
       0.27659574, 0.25531915, 0.25531915, 0.27659574, 0.25531915,
       0.23404255, 0.23404255, 0.21276596, 0.21276596, 0.19148936,
       0.17021277, 0.12765957, 0.10638298, 0.08510638, 0.10638298,
       0.10638298, 0.08510638, 0.08510638, 0.04255319, 0.0212766 ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.0212766 , 0.04255319, 0.06382979, 0.08510638, 0.12765957,
       0.19148936, 0.21276596, 0.23404255, 0.27659574, 0.31914894,
       0.36170213, 0.42553191, 0.46808511, 0.44680851, 0.44680851,
       0.46808511, 0.4893617 , 0.46808511, 0.46808511, 0.4893617 ,
       0.4893617 , 0.4893617 , 0.53191489, 0.4893617 , 0.44680851,
       0.46808511, 0.4893617 , 0.46808511, 0.4893617 , 0.4893617 ,
       0.5106383 , 0.53191489, 0.57446809, 0.59574468, 0.65957447,
       0.70212766, 0.68085106, 0.65957447, 0.65957447, 0.65957447,
       0.63829787, 0.59574468, 0.59574468, 0.57446809, 0.57446809,
       0.53191489, 0.5106383 , 0.5106383 , 0.5106383 , 0.4893617 ,
       0.5106383 , 0.5106383 , 0.4893617 , 0.5106383 , 0.53191489,
       0.4893617 , 0.4893617 , 0.5106383 , 0.5106383 , 0.5106383 ,
       0.53191489, 0.5106383 , 0.4893617 , 0.5106383 , 0.5106383 ,
       0.5106383 , 0.55319149, 0.55319149, 0.57446809, 0.57446809,
       0.57446809, 0.57446809, 0.57446809, 0.57446809, 0.57446809,
       0.57446809, 0.59574468, 0.61702128, 0.61702128, 0.63829787,
       0.63829787, 0.63829787, 0.63829787, 0.63829787, 0.63829787,
       0.61702128, 0.61702128, 0.59574468, 0.57446809, 0.57446809,
       0.57446809, 0.55319149, 0.53191489, 0.53191489, 0.55319149,
       0.53191489, 0.53191489, 0.5106383 , 0.5106383 , 0.5106383 ,
       0.5106383 , 0.5106383 , 0.5106383 , 0.5106383 , 0.55319149,
       0.55319149, 0.57446809, 0.59574468, 0.61702128, 0.63829787,
       0.63829787, 0.63829787, 0.63829787, 0.63829787, 0.65957447,
       0.63829787, 0.61702128, 0.63829787, 0.65957447, 0.65957447,
       0.68085106, 0.68085106, 0.68085106, 0.70212766, 0.70212766,
       0.68085106, 0.65957447, 0.63829787, 0.63829787, 0.61702128,
       0.55319149, 0.5106383 , 0.44680851, 0.40425532, 0.36170213,
       0.29787234, 0.25531915, 0.21276596, 0.19148936, 0.17021277,
       0.12765957, 0.08510638, 0.08510638, 0.10638298, 0.14893617,
       0.21276596, 0.27659574, 0.31914894, 0.34042553, 0.34042553,
       0.38297872, 0.36170213, 0.38297872, 0.40425532, 0.40425532,
       0.44680851, 0.42553191]),[0.18421053, 0.31578947, 0.44736842, 0.55263158, 0.65789474,
       0.73684211, 0.78947368, 0.78947368, 0.81578947, 0.89473684,
       0.89473684, 0.89473684, 0.86842105, 0.86842105, 0.86842105,
       0.84210526, 0.84210526, 0.86842105, 0.86842105, 0.86842105,
       0.86842105, 0.86842105, 0.84210526, 0.78947368, 0.81578947,
       0.78947368, 0.73684211, 0.73684211, 0.73684211, 0.76315789,
       0.76315789, 0.76315789, 0.76315789, 0.73684211, 0.71052632,
       0.71052632, 0.71052632, 0.68421053, 0.68421053, 0.71052632,
       0.65789474, 0.63157895, 0.63157895, 0.60526316, 0.60526316,
       0.60526316, 0.57894737, 0.57894737, 0.55263158, 0.5       ,
       0.44736842, 0.39473684, 0.34210526, 0.34210526, 0.31578947,
       0.31578947, 0.31578947, 0.34210526, 0.34210526, 0.31578947,
       0.28947368, 0.28947368, 0.28947368, 0.26315789, 0.31578947,
       0.34210526, 0.34210526, 0.34210526, 0.39473684, 0.44736842,
       0.47368421, 0.47368421, 0.47368421, 0.47368421, 0.5       ,
       0.47368421, 0.47368421, 0.44736842, 0.42105263, 0.39473684,
       0.36842105, 0.36842105, 0.34210526, 0.34210526, 0.34210526,
       0.31578947, 0.26315789, 0.26315789, 0.23684211, 0.21052632,
       0.15789474, 0.13157895, 0.07894737, 0.        , 0.02631579,
       0.05263158, 0.10526316, 0.18421053, 0.26315789, 0.42105263,
       0.47368421, 0.52631579, 0.55263158, 0.52631579, 0.5       ,
       0.5       , 0.5       , 0.47368421, 0.5       , 0.5       ,
       0.47368421, 0.47368421, 0.5       , 0.44736842, 0.42105263,
       0.39473684, 0.36842105, 0.36842105, 0.36842105, 0.39473684,
       0.39473684, 0.39473684, 0.39473684, 0.42105263, 0.44736842,
       0.47368421, 0.47368421, 0.47368421, 0.5       , 0.47368421,
       0.5       , 0.5       , 0.5       , 0.55263158, 0.52631579,
       0.55263158, 0.57894737, 0.57894737, 0.57894737, 0.63157895,
       0.63157895, 0.60526316, 0.57894737, 0.52631579, 0.47368421,
       0.47368421, 0.47368421, 0.47368421, 0.47368421, 0.44736842,
       0.42105263, 0.42105263, 0.42105263, 0.42105263, 0.39473684,
       0.39473684, 0.42105263, 0.36842105, 0.39473684, 0.42105263,
       0.42105263, 0.42105263, 0.42105263, 0.39473684, 0.36842105,
       0.34210526, 0.36842105, 0.36842105, 0.36842105, 0.42105263,
       0.47368421, 0.44736842, 0.44736842, 0.47368421, 0.5       ,
       0.5       , 0.52631579, 0.52631579, 0.52631579, 0.55263158,
       0.52631579, 0.47368421, 0.47368421, 0.44736842, 0.44736842,
       0.42105263, 0.39473684, 0.39473684, 0.39473684, 0.42105263,
       0.42105263, 0.42105263, 0.42105263, 0.42105263, 0.44736842,
       0.44736842, 0.42105263, 0.42105263, 0.42105263, 0.42105263,
       0.36842105, 0.36842105, 0.36842105, 0.34210526, 0.34210526,
       0.31578947, 0.28947368, 0.28947368, 0.28947368, 0.28947368,
       0.31578947, 0.31578947, 0.28947368, 0.23684211, 0.21052632,
       0.21052632, 0.21052632, 0.23684211, 0.26315789, 0.26315789,
       0.31578947, 0.34210526, 0.39473684, 0.42105263, 0.47368421,
       0.52631579, 0.57894737, 0.60526316, 0.63157895, 0.65789474,
       0.68421053, 0.73684211, 0.78947368, 0.78947368, 0.78947368,
       0.78947368, 0.78947368, 0.76315789, 0.76315789, 0.76315789,
       0.76315789, 0.73684211, 0.76315789, 0.76315789, 0.71052632,
       0.71052632, 0.71052632, 0.71052632, 0.71052632, 0.71052632,
       0.71052632, 0.73684211, 0.78947368, 0.84210526, 0.86842105,
       0.89473684, 0.89473684, 0.86842105, 0.84210526, 0.84210526,
       0.81578947, 0.78947368, 0.78947368, 0.76315789, 0.73684211,
       0.71052632, 0.68421053, 0.68421053, 0.71052632, 0.68421053,
       0.68421053, 0.68421053, 0.68421053, 0.65789474, 0.68421053,
       0.68421053, 0.65789474, 0.68421053, 0.71052632, 0.68421053,
       0.71052632, 0.68421053, 0.65789474, 0.65789474, 0.63157895,
       0.68421053, 0.68421053, 0.73684211, 0.73684211, 0.71052632,
       0.71052632, 0.71052632, 0.71052632, 0.71052632, 0.68421053,
       0.68421053, 0.71052632, 0.76315789, 0.73684211, 0.76315789,
       0.76315789, 0.73684211, 0.76315789, 0.76315789, 0.76315789,
       0.76315789, 0.76315789, 0.73684211, 0.71052632, 0.73684211,
       0.71052632, 0.71052632, 0.71052632, 0.68421053, 0.68421053,
       0.68421053, 0.68421053, 0.63157895, 0.65789474, 0.65789474,
       0.65789474, 0.65789474, 0.68421053, 0.71052632, 0.73684211,
       0.73684211, 0.76315789, 0.78947368, 0.81578947, 0.84210526,
       0.84210526, 0.84210526, 0.84210526, 0.86842105, 0.86842105,
       0.84210526, 0.86842105, 0.89473684, 0.92105263, 0.92105263,
       0.92105263, 0.97368421, 0.94736842, 1.        , 0.97368421,
       0.97368421, 0.94736842, 0.94736842, 0.92105263, 0.92105263,
       0.84210526, 0.78947368, 0.73684211, 0.65789474, 0.60526316,
       0.57894737, 0.52631579, 0.5       , 0.5       , 0.44736842,
       0.39473684, 0.34210526, 0.36842105, 0.39473684, 0.42105263,
       0.47368421, 0.55263158, 0.60526316, 0.60526316, 0.63157895,
       0.68421053, 0.68421053, 0.68421053, 0.71052632, 0.73684211,
       0.73684211, 0.76315789]
new_data_array = np.array(new_data).flatten()
result = check_drunk_or_sober(new_data_array)